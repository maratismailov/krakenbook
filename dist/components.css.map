{
  "version": 3,
  "file": "components.css",
  "sources": [
    "../App.svelte",
    "../Search.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import HelloWorld from \"./components/HelloWorld.svelte\";\n  import Search from \"./components/Search.svelte\";\n  import Library from \"./components/Library.svelte\";\n  import Settings from \"./components/Settings.svelte\";\n  import { Router, Link, Route } from \"svelte-routing\";\n\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.register(\"/service-worker.js\");\n  }\n\n  export let url = \"\";\n</script>\n\n<style lang=\"postcss\">.navbar{width:100%;bottom:0;position:fixed;background-color:#1e1e1e}img{max-height:1.2em;display:block;margin-left:auto;margin-right:auto}\n/*# sourceMappingURL=src/App.svelte.map */</style>\n\n<main class=\"overflow-hidden \">\n  <!-- <Router/> -->\n  <!-- <HelloWorld/> -->\n  <!-- <Search/> -->\n</main>\n\n<Router {url}>\n  <div class=\"navbar\">\n    <Link to=\"/\">\n      <img src=\"assets/search.svg\" alt=\"Search\" />\n    </Link>\n    <Link to=\"library\">\n      <img src=\"assets/library.svg\" alt=\"library\" />\n    </Link>\n    <Link to=\"settings\">\n      <img src=\"assets/settings.svg\" alt=\"settings\" />\n    </Link>\n\n  </div>\n\n  <div>\n    <!-- <Route path=\"blog/:id\" component=\"{BlogPost}\" /> -->\n    <!-- <Route path=\"blog\" component=\"{Blog}\" /> -->\n    <Route path=\"library\" component={Library} />\n    <Route path=\"settings\" component={Settings} />\n    <Route path=\"/\">\n      <Search />\n    </Route>\n  </div>\n</Router>\n",
    "<script>\n  import axios from \"axios\";\n  import { parse } from \"node-html-parser\";\n  import { beforeUpdate, afterUpdate, onMount } from \"svelte\";\n  import { fly } from \"svelte/transition\";\n  import { saveAs } from \"file-saver\";\n  // import { download } from \"downloadjs\"\n\n  let querie = null;\n  let page_number = 0;\n  let result = \"\";\n  let results = \"\";\n  let series_checked = false;\n  let author_checked = false;\n  let book_checked = true;\n  let pages_total = 0;\n  let prev_button = \"Hidden\";\n  let next_button = \"Hidden\";\n  let is_pages = \"Hidden\";\n  let loading = \"Hidden\";\n  let loading_details = \"Hidden\";\n  let results_css = \"Hidden\";\n  let book_menu = [];\n  let details = [];\n  let details_text = \"\";\n  let show_details = [];\n  let allbooks = [];\n  let show_details_btn = null;\n  let show_details_img = null;\n  let show_download_options = null;\n  let download_links = [];\n\n  function handleEnter(event) {\n    // key = event.key;\n    let key_code = event.keyCode;\n    if (key_code === 13) {\n      document.getElementById(\"search_input\").blur();\n      handleNewSearch();\n    }\n  }\n\n  beforeUpdate(() => {\n    show_details_btn = document.getElementById(\"show_details_btn\");\n    show_details_img = document.getElementById(\"show_details_img\");\n    prev_button = \"Hidden\";\n    if (page_number > 0) {\n      prev_button =\n        \"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\";\n    }\n\n    next_button =\n      \"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\";\n    if (page_number >= pages_total - 1) {\n      next_button = \"Hidden\";\n    }\n\n    is_pages = \"Hidden\";\n    if (pages_total !== 0) {\n      is_pages =\n        \"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\";\n    }\n    // determine whether we should auto-scroll\n    // once the DOM is updated...\n  });\n\n  export function changePageNumber(arg) {\n    page_number += arg;\n    handleSearch();\n  }\n\n  export function getBlob() {\n    // \"http://flibusta.is/b/236755/fb2\"\n    // \"http://static.flibusta.is:443/b.fb2/Sever_Stalin-protiv-vyrodkov-Arbata-.M0SIqg.236755.fb2.zip\"\n    // window.Blob(\"http://flibusta.is/b/236755/fb2\");\n    fetch(\"http://flibusta.is/b/236755/fb2\", {\n      mode: 'no-cors',\n       headers: {\n      'Content-Type': 'application/zip'\n    }\n    }).then(response => console.log(response))\n    .catch(err => console.log(err))\n  }\n\n  export function getBlob2() {\n    // download(\"data:http://flibusta.is/b/236755/fb2\", \"book.fb2.zip\", \"application/zip\")\n  }\n\n  export function handleSearch() {\n    results_css = \"Hidden\";\n    loading = null;\n    let pre_querie = querie.replace(/ /g, \"+\");\n    if (series_checked) {\n      pre_querie = pre_querie + \"&chs=on\";\n    }\n    if (author_checked) {\n      pre_querie = pre_querie + \"&cha=on\";\n    }\n    if (book_checked) {\n      pre_querie = pre_querie + \"&chb=on\";\n    }\n    if (book_checked || series_checked || author_checked) {\n      const search_querie =\n        \"https://flibustasearch.herokuapp.com/http://flibusta.is/booksearch?page=\" +\n        page_number +\n        \"&ask=\" +\n        pre_querie;\n      axios.get(search_querie).then(response => {\n        result = response.data;\n        refineResult();\n        // this.setState({ result: response.data }, () => this.refineResult());\n      });\n    }\n\n    // pre_querie = pre_querie + \"&chb=on\";\n  }\n\n  export function handleNewSearch() {\n    page_number = 0;\n    handleSearch();\n  }\n\n  export function hideDetails(event) {\n    if (\n      event.target !== show_details_btn &&\n      event.target !== show_details_img\n    ) {\n      show_details = [];\n    }\n  }\n\n  export function showDetails(index) {\n    show_details[index] = !show_details[index];\n    let pre_details_link = parse(allbooks[index]).firstChild.firstChild\n      .rawAttrs;\n    pre_details_link = pre_details_link.substr(6);\n    let details_link = pre_details_link.slice(0, -1);\n    const details_querie =\n      \"https://flibustasearch.herokuapp.com/\" + details_link;\n    let details_body = \"\";\n    axios.get(details_querie).then(response => {\n      details_body = response.data;\n      refineDetails(details_body);\n    });\n  }\n\n  export function showDownloadOptions(index) {\n    show_download_options[index] = !show_download_options[index];\n    let download_link = parse(allbooks[index])\n      .firstChild.firstChild.rawAttrs.substr(6)\n      .slice(0, -1);\n    download_links[index] = {\n      fb2: download_link + \"/fb2\",\n      epub: download_link + \"/epub\",\n      mobi: download_link + \"/mobi\"\n    };\n  }\n\n  export function downloadBook(index, type) {\n    let download_link =\n      parse(allbooks[index])\n        .firstChild.firstChild.rawAttrs.substr(6)\n        .slice(0, -1) + type;\n    const link = document.createElement(\"a\");\n    link.href = download_link;\n    link.click();\n\n    console.log(download_link);\n  }\n\n  export function refineDetails(details) {\n    loading_details = \"Hidden\";\n    const details0 = String(details);\n    const result1 = details0.substring(details0.indexOf('<h1 class=\"title\">'));\n    const result2 = result1.substring(\n      0,\n      result1.indexOf(\"<hr/><div id='newann'\")\n    );\n    // details_text = parse(result2).text\n\n    const url = \"http://flibusta.is\";\n    const result3 = result2.replace(/<a\\b[^>]*>(.*?)<\\/a>/g, \"\");\n    const result5 = result3.replace(\n      /<[a-zA-Z]+(\\s+[a-zA-Z]+\\s*=\\s*(\"([^\"]*)\"|'([^']*)'))*\\s*\\/>/,\n      \"\"\n    );\n    const position = result5.indexOf('<img src=\"') + 10;\n    const result6 = [\n      result5.slice(0, position),\n      url,\n      result5.slice(position)\n    ].join(\"\");\n    details_text = result6;\n    console.log(details_text);\n  }\n\n  export function refineResult() {\n    loading = \"Hidden\";\n    const result0 = String(result);\n    const result1 = result0.substring(\n      result.indexOf('<h1 class=\"title\">Поиск книг</h1>') + 0\n    );\n    const result2 = result1.substring(\n      0,\n      result1.indexOf('<div id=\"sidebar-right\" class=\"sidebar\">')\n    );\n    const array1 = result2.split(\"\\n\");\n    const array2 = array1.filter(String);\n    pages_total = array2.filter(elem => {\n      if (\n        elem.includes('class=\"pager\"') ||\n        elem.includes('<li class=\"pager-item\"')\n      ) {\n        return true;\n      }\n    });\n\n    const array3 = array2.filter(elem => {\n      if (elem.includes('h1 class=\"title\"')) {\n        return false;\n      }\n      if (elem.includes(\"input type=submit value\")) {\n        return false;\n      }\n      if (elem.includes('<input type=\"checkbox\"')) {\n        return false;\n      }\n      if (elem.includes('<a href=\"http://fbsearch.ru\">')) {\n        return false;\n      }\n      if (elem.includes('class=\"pager')) {\n        return false;\n      }\n\n      return true;\n    });\n    // const array6 = array3.map\n\n    const array5 = array3.map((elem, index) => {\n      if (elem.includes(\"<ul>\")) {\n        elem = elem.substr(elem.indexOf(\"<ul>\") + 4);\n        // console.log('found!')\n      }\n      elem = elem.replace(/<span style=\"background-color: #FFFCBB\">/g, \"\");\n      elem = elem.replace(/<\\/span>/g, \"\");\n      elem = elem.replace(\"<b>\", \"\");\n      elem = elem.replace(\"</b>\", \"\");\n      elem = elem.replace(/<a href=\"\\//g, '<a href=\"http://flibusta.is/');\n\n      // if (elem.includes(\"flibusta.is/b\")) {\n      //   elem =\n      //     elem +\n      //     elem.substring(elem.indexOf(\"<a href\"), elem.indexOf('\">')) +\n      //     '/fb2\">fb2 </a>' +\n      //     elem.substring(elem.indexOf(\"<a href\"), elem.indexOf('\">')) +\n      //     '/epub\">epub </a>' +\n      //     elem.substring(elem.indexOf(\"<a href\"), elem.indexOf('\">')) +\n      //     '/mobi\">mobi</a>';\n      // }\n\n      return elem;\n    });\n\n    const array6 = array5.map(elem => {\n      elem = parse(elem);\n      return elem.structuredText;\n    });\n    book_menu = array5.map(() => {\n      return null;\n    });\n    show_details = array5.map(() => {\n      return null;\n    });\n    show_download_options = array5.map(() => {\n      return null;\n    });\n    details = array5.map(() => {\n      return null;\n    });\n    allbooks = array5.map(elem => {\n      return elem;\n    });\n\n    // console.log('array6 is', array6);\n    // result = parse(array5)\n    results = array6;\n    results_css = \"text-maintxt m-2\";\n    // this.setState({ result2: array6, pagesTotal: pagesTotal.length / 2 });\n    // result2 = array6\n    pages_total = pages_total.length / 2;\n  }\n  export function showBookMenu(index) {\n    book_menu[index] = !book_menu[index];\n  }\n</script>\n\n<style>.switch{position:relative;display:inline-block;width:2em;height:1.1em}.switch input{opacity:0;width:0;height:0}.slider{cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc}.slider,.slider:before{position:absolute;transition:.4s}.slider:before{content:\"\";height:1.1em;width:1em;background-color:#fff}input:checked+.slider{background-color:#2196f3}input:focus+.slider{box-shadow:0 0 1px #2196f3}input:checked+.slider:before{transform:translateX(1em)}.slider.round{border-radius:1em}.slider.round:before{border-radius:50%}.Pages{display:flex}.Hidden{display:none}.Button{height:50%;margin:1%}hr{background-color:#375a7f;height:1px}.outer_details_div{margin-left:2vw;margin-right:2vw;width:90vw;height:50vh;z-index:1;position:absolute;overflow:auto;background-color:#0b3a32}.div_for_button{text-align:center}\n/*# sourceMappingURL=src/components/Search.svelte.map */</style>\n\n<svelte:head>\n  <title>kraken book</title>\n</svelte:head>\n<svelte:window on:keydown={handleEnter} on:click={hideDetails} />\n\n<div class=\"\">\n  <input\n    id=\"search_input\"\n    class=\"bg-white focus:outline-none border border-gray-300 rounded-lg py-2\n    px-4 w-9 static m-2\"\n    type=\"search\"\n    placeholder=\"Enter book name\"\n    bind:value={querie} />\n  <button\n    class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\"\n    on:click={handleNewSearch}>\n    Search\n  </button>\n  <button\n    class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\"\n    on:click={getBlob}>\n    blob\n  </button>\n  <a\n    href=\"http://static.flibusta.is:443/b.fb2/Sever_Stalin-protiv-vyrodkov-Arbata-.M0SIqg.236755.fb2.zip\">\n    zip\n  </a>\n</div>\n\n<div class=\"m-2 text-maintxt\">\n  <label class=\"switch\">\n    <input type=\"checkbox\" bind:checked={series_checked} />\n    <span class=\"slider round\" />\n  </label>\n  <span>Серии</span>\n  <span>&nbsp;</span>\n  <label class=\"switch\">\n    <input type=\"checkbox\" bind:checked={author_checked} />\n    <span class=\"slider round\" />\n  </label>\n  <span>Авторы</span>\n  <span>&nbsp;</span>\n  <label class=\"switch\">\n    <input type=\"checkbox\" bind:checked={book_checked} />\n    <span class=\"slider round\" />\n  </label>\n  <span>Книги</span>\n  <span>&nbsp;</span>\n\n  <div class=\"Pages\">\n    <button class={prev_button} on:click={() => changePageNumber(-1)}>\n      Предыдущая\n    </button>\n    <p class={is_pages}>Страница {page_number + 1} из {pages_total}</p>\n    <button class={next_button} on:click={() => changePageNumber(1)}>\n      Следующая\n    </button>\n  </div>\n\n</div>\n<div class={loading}>\n  <img src=\"./assets/loading.svg\" alt=\"Loading...\" />\n</div>\n\n<div class={results_css}>\n  {#each results as result, index}\n    {#if result.includes('Найденные книги') || result.includes('Найденные писатели') || result.includes('Найденные серии')}\n      <h2 style=\"font-size: 1.5em\">{result}</h2>\n    {:else if result.length > 0}\n      <div on:click={() => showBookMenu(index)}>{result}</div>\n      {#if book_menu[index]}\n        <div\n          transition:fly={{ y: -25, duration: 500 }}\n          style=\"color: green; display: flex\">\n          <button\n            id=\"show_details_btn\"\n            class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\"\n            on:click={() => showDetails(index)}>\n            <img\n              id=\"show_details_img\"\n              style=\"max-height: 1em\"\n              src=\"./assets/details.svg\"\n              alt=\"details\" />\n          </button>\n          <button\n            style=\"display: flex\"\n            class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\"\n            on:click={() => showDetails(index)}>\n            <img\n              style=\"max-height: 1em\"\n              src=\"./assets/library.svg\"\n              alt=\"library\" />\n          </button>\n          <button\n            class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2 px-4\"\n            on:click={() => showDownloadOptions(index)}>\n            <img\n              style=\"max-height: 1em\"\n              src=\"./assets/download.svg\"\n              alt=\"download\" />\n          </button>\n          {#if show_download_options[index]}\n            <!-- <button\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              on:click={() => downloadBook(index, '/fb2')}>\n              fb2\n            </button>\n            <button\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              on:click={() => downloadBook(index, '/epub')}>\n              epub\n            </button>\n            <button\n              type=\"button\"\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              on:click={() => downloadBook(index, '/mobi')}>\n              mobi\n            </button>\n            <form action={download_links[index].mobi}>\n              <input type=\"submit\" value=\"Go to Google\" />\n            </form> -->\n            <a\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              href={download_links[index].fb2}\n              download>\n              fb2\n            </a>\n            <a\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              href={download_links[index].epub}\n              download>\n              epub\n            </a>\n            <a\n              class=\"text-maintxt focus:outline-none bg-mainbtn m-2 static\n              rounded-lg py-2 px-4\"\n              href={download_links[index].mobi}\n              download>\n              mobi\n            </a>\n          {/if}\n        </div>\n        {#if show_details[index]}\n          <div class=\"outer_details_div\">\n            <div class=\"div_for_button\">\n              <button\n                class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2\n                px-4\"\n                on:click={() => showDetails(index)}>\n                Закрыть\n              </button>\n            </div>\n            <div>\n              {@html details_text}\n            </div>\n            <div class=\"div_for_button\">\n              <button\n                class=\"focus:outline-none bg-mainbtn m-2 static rounded-lg py-2\n                px-4\"\n                on:click={() => showDetails(index)}>\n                Закрыть\n              </button>\n            </div>\n          </div>\n        {/if}\n      {/if}\n      <hr />\n    {/if}\n  {/each}\n</div>\n<div style=\"padding-bottom: 80px;\" />\n"
  ],
  "names": [],
  "mappings": "AAcsB,sBAAO,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS,KAAK,CAAC,iBAAiB,OAAO,CAAC,kBAAG,CAAC,WAAW,KAAK,CAAC,QAAQ,KAAK,CAAC,YAAY,IAAI,CAAC,aAAa,IAAI,CAAC;ACyRzJ,mCAAO,CAAC,SAAS,QAAQ,CAAC,QAAQ,YAAY,CAAC,MAAM,GAAG,CAAC,OAAO,KAAK,CAAC,qBAAO,CAAC,mBAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,mCAAO,CAAC,OAAO,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,iBAAiB,IAAI,CAAC,mCAAO,CAAC,mCAAO,OAAO,CAAC,SAAS,QAAQ,CAAC,WAAW,GAAG,CAAC,mCAAO,OAAO,CAAC,QAAQ,EAAE,CAAC,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,iBAAiB,IAAI,CAAC,KAAK,QAAQ,CAAC,mCAAO,CAAC,iBAAiB,OAAO,CAAC,KAAK,MAAM,CAAC,mCAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,QAAQ,CAAC,mCAAO,OAAO,CAAC,UAAU,WAAW,GAAG,CAAC,CAAC,OAAO,kCAAM,CAAC,cAAc,GAAG,CAAC,OAAO,kCAAM,OAAO,CAAC,cAAc,GAAG,CAAC,kCAAM,CAAC,QAAQ,IAAI,CAAC,mCAAO,CAAC,QAAQ,IAAI,CAAC,mCAAO,CAAC,OAAO,GAAG,CAAC,OAAO,EAAE,CAAC,8BAAE,CAAC,iBAAiB,OAAO,CAAC,OAAO,GAAG,CAAC,8CAAkB,CAAC,YAAY,GAAG,CAAC,aAAa,GAAG,CAAC,MAAM,IAAI,CAAC,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,SAAS,QAAQ,CAAC,SAAS,IAAI,CAAC,iBAAiB,OAAO,CAAC,2CAAe,CAAC,WAAW,MAAM,CAAC"
}